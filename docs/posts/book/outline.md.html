<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="notes">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/nealcaren"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://bsky.app/profile/haphazardsoc.bsky.social"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="python-for-computational-social-science-a-hands-on-approach" class="level1">
<h1>Python for Computational Social Science: A Hands-on Approach</h1>
<section id="part-1-foundations-of-computational-social-science" class="level2">
<h2 class="anchored" data-anchor-id="part-1-foundations-of-computational-social-science">Part 1: Foundations of Computational Social Science</h2>
<section id="chapter-1-introduction" class="level3">
<h3 class="anchored" data-anchor-id="chapter-1-introduction">Chapter 1: Introduction</h3>
<section id="introduction" class="level4">
<h4 class="anchored" data-anchor-id="introduction">Introduction</h4>
<ul>
<li>The definition and scope of Computational Social Science</li>
<li>The interdisciplinary nature of the field #### Role of Python in Computational Social Science</li>
<li>Why Python is a popular choice: Versatility and community support</li>
<li>Overview of Python packages relevant to social sciences (e.g., pandas, numpy) #### Ethical Considerations</li>
<li>Discussing ethical concerns and considerations in computational research #### Overview of the Book</li>
<li>Summary of each part and what readers can expect to learn</li>
</ul>
</section>
</section>
<section id="chapter-2-getting-started-with-python" class="level3">
<h3 class="anchored" data-anchor-id="chapter-2-getting-started-with-python">Chapter 2: Getting Started with Python</h3>
<section id="setting-up-your-python-environment" class="level4">
<h4 class="anchored" data-anchor-id="setting-up-your-python-environment">Setting Up Your Python Environment</h4>
<ul>
<li><strong>Choosing and Installing Python</strong>: Discuss the merits of using Anaconda for beginners, which includes a package manager and a suite of pre-installed libraries ideal for data science. Compare this with native Python installers, which might be preferred for more customized setups.</li>
<li><strong>Setting Up Your Workspace</strong>: Compare the user-friendly, browser-based Google Colab, which requires no installation and offers free access to GPUs, with traditional Integrated Development Environments (IDEs) like PyCharm and Visual Studio Code. Highlight the advantages of each, particularly in terms of features, user interface, and suitability for larger projects.</li>
</ul>
</section>
<section id="managing-python-packages-and-environments" class="level4">
<h4 class="anchored" data-anchor-id="managing-python-packages-and-environments">Managing Python Packages and Environments</h4>
<ul>
<li><strong>Understanding Python Environments</strong>: Explain the concept of virtual environments and their importance in managing dependencies and Python versions for different projects.</li>
<li><strong>Installing Packages</strong>: Guide on using <code>pip</code> and <code>conda</code> for installing Python packages like Scikit-learn, Matplotlib, and Pandas. Provide examples of common commands and practices for maintaining up-to-date and secure package installations.</li>
</ul>
</section>
<section id="writing-your-first-python-script" class="level4">
<h4 class="anchored" data-anchor-id="writing-your-first-python-script">Writing Your First Python Script</h4>
<ul>
<li><strong>Basic Syntax and Operations</strong>: Introduce Python syntax, focusing on readability and simplicity. Explain variables, common data types (integers, floats, strings, lists), and basic arithmetic operations. Include examples that are relevant to social science data.</li>
<li><strong>Controlling Flow</strong>: Explain the significance of control structures in managing the flow of a Python program. Provide examples of if statements for decision-making processes and loops (for and while) for iterating over data sets.</li>
</ul>
</section>
<section id="exploring-python-libraries-for-social-science" class="level4">
<h4 class="anchored" data-anchor-id="exploring-python-libraries-for-social-science">Exploring Python Libraries for Social Science</h4>
<ul>
<li><strong>Scikit-learn</strong>: Introduce Scikit-learn as a versatile tool for machine learning in Python. Discuss its applications in statistical modeling and prediction, with examples relevant to social science like logistic regression and clustering.</li>
<li><strong>Matplotlib</strong>: Explain how Matplotlib can be used to visualize data, which is crucial in understanding trends and patterns. Show simple plot types like line graphs and histograms.</li>
<li><strong>Pandas</strong>: Describe how Pandas provides data structures and data analysis tools, which make manipulating numerical tables and time series easy and intuitive. Provide examples showing data manipulation tasks common in social science, like filtering data and merging datasets.</li>
</ul>
</section>
<section id="developing-good-programming-habits" class="level4">
<h4 class="anchored" data-anchor-id="developing-good-programming-habits">Developing Good Programming Habits</h4>
<ul>
<li><strong>Coding Best Practices</strong>: Discuss the importance of writing clean and readable code. Cover concepts like naming conventions, commenting, and the DRY principle (Don’t Repeat Yourself). Introduce the concept of refactoring and regular code reviews.</li>
<li><strong>Using Version Control</strong>: Provide an introduction to version control systems, focusing on git. Discuss how git can help manage changes to source code over time, including tracking modifications, reverting to previous versions, and collaborating with others. Offer a basic tutorial on setting up git, committing changes, and pushing to a repository like GitHub.</li>
</ul>
</section>
</section>
<section id="chapter-3-loading-files" class="level3">
<h3 class="anchored" data-anchor-id="chapter-3-loading-files">Chapter 3: Loading Files</h3>
<section id="introduction-to-file-types" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-file-types">Introduction to File Types</h4>
<ul>
<li>Overview of different file formats: CSV, JSON, and text files</li>
<li>Discussion on the relevance of each format in social science research #### Reading Files in Python</li>
<li>Using pandas to read CSV and Excel files</li>
<li>Reading JSON files and converting to pandas DataFrame #### Handling Large Data Sets</li>
<li>Techniques for managing large files in memory</li>
<li>Use of <code>dask</code> or <code>pandas</code> chunking features</li>
</ul>
</section>
</section>
</section>
<section id="part-2-data-acquisition" class="level2">
<h2 class="anchored" data-anchor-id="part-2-data-acquisition">Part 2: Data Acquisition</h2>
<section id="chapter-4-web-scraping" class="level3">
<h3 class="anchored" data-anchor-id="chapter-4-web-scraping">Chapter 4: Web Scraping</h3>
<section id="introduction-to-web-scraping" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-web-scraping">Introduction to Web Scraping</h4>
<ul>
<li>Legal and ethical considerations in web scraping</li>
<li>Overview of HTML and CSS selectors #### Python Tools for Web Scraping</li>
<li>Introduction to <code>BeautifulSoup</code> and <code>requests</code></li>
<li>Advanced scraping with <code>Scrapy</code> #### Practical Examples</li>
<li>Scraping social media data for sociological analysis</li>
<li>Extracting data from online forums and academic journals</li>
</ul>
</section>
</section>
<section id="chapter-5-apis" class="level3">
<h3 class="anchored" data-anchor-id="chapter-5-apis">Chapter 5: APIs</h3>
<section id="introduction-to-apis" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-apis">Introduction to APIs</h4>
<ul>
<li>What is an API and how it works</li>
<li>Importance of APIs in social science research #### Working with APIs in Python</li>
<li>Using <code>requests</code> to access API data</li>
<li>Handling JSON responses and converting to useful formats #### Case Studies</li>
<li>Accessing government data via APIs for social research</li>
<li>Using Twitter API to gather data on public opinions</li>
</ul>
</section>
</section>
</section>
<section id="part-3-text-data-processing-and-analysis" class="level2">
<h2 class="anchored" data-anchor-id="part-3-text-data-processing-and-analysis">Part 3: Text Data Processing and Analysis</h2>
<section id="chapter-6-working-with-text-data" class="level3">
<h3 class="anchored" data-anchor-id="chapter-6-working-with-text-data">Chapter 6: Working with Text Data</h3>
<section id="introduction-1" class="level4">
<h4 class="anchored" data-anchor-id="introduction-1">Introduction</h4>
<ul>
<li>Importance of text data in computational social science</li>
<li>Overview of the text processing pipeline #### Common Text Preprocessing Steps</li>
<li>Techniques such as lowercasing, punctuation removal, tokenization, stop word removal, and stemming/lemmatization</li>
<li>Python examples using <code>nltk</code> and <code>spaCy</code> #### Handling Special Cases</li>
<li>Addressing URLs, emojis, slang, and part-of-speech tagging</li>
<li>Utilizing libraries like <code>emoji</code> and <code>re</code> (regular expressions) #### Advanced Preprocessing Techniques</li>
<li>Named Entity Recognition (NER) with <code>spaCy</code></li>
<li>Applications of NER in sociological research #### Putting It All Together</li>
<li>Creating a complete preprocessing pipeline with Python</li>
<li>Example scripts and best practices</li>
</ul>
</section>
</section>
<section id="chapter-7-words-to-numbers" class="level3">
<h3 class="anchored" data-anchor-id="chapter-7-words-to-numbers">Chapter 7: Words to Numbers</h3>
<section id="introduction-to-text-analysis-techniques" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-text-analysis-techniques">Introduction to Text Analysis Techniques</h4>
<ul>
<li>Explanation of techniques like TF/IDF and their importance in textual analysis #### Implementing TF/IDF in Python</li>
<li>Using <code>sklearn</code> to implement TF/IDF</li>
<li>Example: Analyzing academic sociology articles #### Beyond TF/IDF</li>
<li>Introduction to more complex vectorization techniques</li>
</ul>
</section>
</section>
<section id="chapter-8-word-and-sentence-embeddings" class="level3">
<h3 class="anchored" data-anchor-id="chapter-8-word-and-sentence-embeddings">Chapter 8: Word and Sentence Embeddings</h3>
<section id="introduction-to-embeddings" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-embeddings">Introduction to Embeddings</h4>
<ul>
<li>Explaining the concept and importance of embeddings in natural language processing #### Generating Embeddings</li>
<li>Using <code>gensim</code> for word embeddings</li>
<li>Introduction to <code>BERT</code> embeddings for sentences #### Applications</li>
<li>Case studies on analyzing social media data for sociological insights</li>
</ul>
</section>
</section>
</section>
<section id="part-4-advanced-text-analysis-techniques" class="level2">
<h2 class="anchored" data-anchor-id="part-4-advanced-text-analysis-techniques">Part 4: Advanced Text Analysis Techniques</h2>
<section id="chapter-9-sentiment-analysis" class="level3">
<h3 class="anchored" data-anchor-id="chapter-9-sentiment-analysis">Chapter 9: Sentiment Analysis</h3>
<section id="introduction-to-sentiment-analysis" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-sentiment-analysis">Introduction to Sentiment Analysis</h4>
<ul>
<li>Overview of sentiment analysis and its application in social sciences #### Implementing Sentiment Analysis</li>
<li>Using libraries like <code>TextBlob</code> and <code>VADER</code></li>
<li>Python examples analyzing sentiments in political speeches</li>
</ul>
</section>
</section>
<section id="chapter-10-text-classification" class="level3">
<h3 class="anchored" data-anchor-id="chapter-10-text-classification">Chapter 10: Text Classification</h3>
<section id="basics-of-text-classification" class="level4">
<h4 class="anchored" data-anchor-id="basics-of-text-classification">Basics of Text Classification</h4>
<ul>
<li>Discussion of classification algorithms available in <code>scikit-learn</code> #### Implementing a Classifier</li>
<li>Step-by-step guide to building a text classifier</li>
<li>Example: Classifying news articles by political bias</li>
</ul>
</section>
</section>
<section id="chapter-11-text-and-concept-similarity" class="level3">
<h3 class="anchored" data-anchor-id="chapter-11-text-and-concept-similarity">Chapter 11: Text and Concept Similarity</h3>
<section id="exploring-similarity-metrics" class="level4">
<h4 class="anchored" data-anchor-id="exploring-similarity-metrics">Exploring Similarity Metrics</h4>
<ul>
<li>Overview of cosine similarity and Jaccard index #### Practical Examples</li>
<li>Using similarity measures to analyze sociological theories</li>
</ul>
</section>
</section>
<section id="chapter-12-topic-modeling" class="level3">
<h3 class="anchored" data-anchor-id="chapter-12-topic-modeling">Chapter 12: Topic Modeling</h3>
<section id="introduction-to-topic-modeling" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-topic-modeling">Introduction to Topic Modeling</h4>
<ul>
<li>Explanation of techniques like LDA (Latent Dirichlet Allocation) #### Implementing Topic Modeling</li>
<li>Using <code>gensim</code> to perform LDA</li>
<li>Case study: Discovering themes in sociological research papers</li>
</ul>
</section>
</section>
<section id="chapter-13-text-clustering" class="level3">
<h3 class="anchored" data-anchor-id="chapter-13-text-clustering">Chapter 13: Text Clustering</h3>
<section id="basics-of-clustering" class="level4">
<h4 class="anchored" data-anchor-id="basics-of-clustering">Basics of Clustering</h4>
<ul>
<li>Discussion of clustering algorithms such as K-means and hierarchical clustering #### Implementing Text Clustering</li>
<li>Using <code>scikit-learn</code> for clustering text data</li>
<li>Example: Clustering social media posts to identify community concerns</li>
</ul>
</section>
</section>
<section id="chapter-14-texts-as-networks" class="level3">
<h3 class="anchored" data-anchor-id="chapter-14-texts-as-networks">Chapter 14: Texts as Networks</h3>
<section id="introduction-to-network-analysis" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-network-analysis">Introduction to Network Analysis</h4>
<ul>
<li>Basics of network theory and its application to text #### Building Text Networks</li>
<li>Using <code>NetworkX</code> to create and analyze networks of words or concepts</li>
<li>Case studies on mapping discourse in academic sociology</li>
</ul>
</section>
</section>
</section>
<section id="part-5-large-language-models" class="level2">
<h2 class="anchored" data-anchor-id="part-5-large-language-models">Part 5: Large Language Models</h2>
<section id="chapter-15-large-language-models-in-social-science" class="level3">
<h3 class="anchored" data-anchor-id="chapter-15-large-language-models-in-social-science">Chapter 15: Large Language Models in Social Science</h3>
<section id="introduction-to-large-language-models" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-large-language-models">Introduction to Large Language Models</h4>
<ul>
<li>Overview of models like BERT, GPT-3 #### Using LLMs for Social Science</li>
<li>Practical examples of LLM applications in social research</li>
</ul>
</section>
</section>
<section id="chapter-16-llms-for-data-extraction" class="level3">
<h3 class="anchored" data-anchor-id="chapter-16-llms-for-data-extraction">Chapter 16: LLMs for Data Extraction</h3>
<section id="techniques-for-data-extraction" class="level4">
<h4 class="anchored" data-anchor-id="techniques-for-data-extraction">Techniques for Data Extraction</h4>
<ul>
<li>Detailed guide on using LLMs to extract structured information from text #### Practical Examples</li>
<li>Using LLMs to extract demographic data from unstructured texts</li>
</ul>
</section>
</section>
<section id="chapter-17-other-uses-for-llms-in-the-social-sciences" class="level3">
<h3 class="anchored" data-anchor-id="chapter-17-other-uses-for-llms-in-the-social-sciences">Chapter 17: Other Uses for LLMs in the Social Sciences</h3>
<section id="expanding-the-scope" class="level4">
<h4 class="anchored" data-anchor-id="expanding-the-scope">Expanding the Scope</h4>
<ul>
<li>Overview of novel uses of LLMs in sociology and social science</li>
<li>Case studies on innovative applications</li>
</ul>
</section>
</section>
</section>
<section id="part-6-putting-it-all-together" class="level2">
<h2 class="anchored" data-anchor-id="part-6-putting-it-all-together">Part 6: Putting it All Together</h2>
<section id="chapter-18-reproducibility-and-open-science" class="level3">
<h3 class="anchored" data-anchor-id="chapter-18-reproducibility-and-open-science">Chapter 18: Reproducibility and Open Science</h3>
<section id="best-practices-for-reproducibility" class="level4">
<h4 class="anchored" data-anchor-id="best-practices-for-reproducibility">Best Practices for Reproducibility</h4>
<ul>
<li>Discussing tools and practices to ensure reproducible research #### Promoting Open Science</li>
<li>Encouraging data and code sharing within the social science community</li>
</ul>
</section>
</section>
<section id="chapter-19-ethical-considerations-in-machine-learning-and-data-science" class="level3">
<h3 class="anchored" data-anchor-id="chapter-19-ethical-considerations-in-machine-learning-and-data-science">Chapter 19: Ethical Considerations in Machine Learning and Data Science</h3>
<section id="ethical-challenges" class="level4">
<h4 class="anchored" data-anchor-id="ethical-challenges">Ethical Challenges</h4>
<ul>
<li>Exploring issues of bias, fairness, and data protection #### Implementing Ethical Practices</li>
<li>Strategies for addressing ethical challenges in computational research</li>
</ul>
</section>
</section>
<section id="chapter-20-case-studies-and-practical-exercises" class="level3">
<h3 class="anchored" data-anchor-id="chapter-20-case-studies-and-practical-exercises">Chapter 20: Case Studies and Practical Exercises</h3>
<section id="real-world-applications" class="level4">
<h4 class="anchored" data-anchor-id="real-world-applications">Real-World Applications</h4>
<ul>
<li>Detailed case studies showing the application of computational techniques in social science #### Hands-on Projects</li>
<li>Guided projects and exercises to apply learned skills on real data sets</li>
</ul>
</section>
</section>
<section id="chapter-21-conclusion-and-future-directions" class="level3">
<h3 class="anchored" data-anchor-id="chapter-21-conclusion-and-future-directions">Chapter 21: Conclusion and Future Directions</h3>
<section id="recap-of-key-concepts" class="level4">
<h4 class="anchored" data-anchor-id="recap-of-key-concepts">Recap of Key Concepts</h4>
<ul>
<li>Summary of major points and learnings from the book #### Looking Ahead</li>
<li>Discussing future trends and opportunities in computational social science</li>
</ul>
</section>
</section>
</section>
<section id="exercises-and-further-reading" class="level2">
<h2 class="anchored" data-anchor-id="exercises-and-further-reading">Exercises and Further Reading</h2>
<ul>
<li>Practical exercises for each chapter to reinforce the concepts</li>
<li>Recommended books, articles, and online resources for advanced study</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>